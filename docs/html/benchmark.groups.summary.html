<html>

<head>
    <title>test</title>
    <link rel=stylesheet type="text/css" href="http://ebg.ucalgary.ca/metaamp/css/metaamp.css"
    title="default metaamp styles" />
    <script type="text/javascript" src="http://ebg.ucalgary.ca/metaamp/js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="http://ebg.ucalgary.ca/metaamp/js/Highcharts-5.0.5/code/highcharts.js"></script>
    <script type="text/javascript" src="http://ebg.ucalgary.ca/metaamp/js/Highcharts-5.0.5/code/modules/exporting.js"></script>
    <script type="text/javascript" src="http://ebg.ucalgary.ca/metaamp/js/Highcharts-5.0.5/code/modules/data.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script>
        var charts = [];
        var getChartConfig = function (renderId, sname, titletxt, mydata, dist,
            cat, type, xtitle, ytitle, legend) {
            var config = {};
            config.chart = {
                renderTo: renderId,
                defaultSeriesType: type,
                borderWidth: 2,
                spacingLeft: 20,
                spacingRight: 20,
                spacingTop: 20,
                spacingBottom: 20,
                backgroundColor: {
                    linearGradient: {
                        x1: 0,
                        y1: 0,
                        x2: 1,
                        y2: 1
                    },
                    stops: [
                        [0, 'rgb(255, 255, 255)'],
                        [1, 'rgb(240, 240, 255)']
                    ]
                },
                plotBackgroundColor: 'rgba(255, 255, 255, .9)',
                plotShadow: true,
                plotBorderWidth: 1
            };
            config.credits = {
                enabled: false
            };
            config.title = {
                text: titletxt,
                margin: 30,
                style: {
                    color: '#000',
                    font: 'bold 16px "Trebuchet MS", Verdana, sans-serif'
                }
            };
            config.xAxis = {
                categories: cat,
                gridLineWidth: 1,
                lineColor: '#000',
                tickColor: '#000',
                labels: {
                    style: {
                        color: '#000',
                        font: '11px Trebuchet MS, Verdana, sans-serif'
                    }
                },
                title: {
                    text: xtitle,
                    style: {
                        color: '#333',
                        fontWeight: 'bold',
                        fontSize: '12px',
                        fontFamily: 'Trebuchet MS, Verdana, sans-serif'
                    }
                }
            };
            config.yAxis = [{
                minorTickInterval: 'auto',
                lineColor: '#000',
                lineWidth: 1,
                tickWidth: 1,
                tickColor: '#000',
                labels: {
                    style: {
                        color: '#000',
                        font: '11px Trebuchet MS, Verdana, sans-serif'
                    }
                },
                title: {
                    text: ytitle,
                    style: {
                        color: '#333',
                        fontWeight: 'bold',
                        fontSize: '12px',
                        fontFamily: 'Trebuchet MS, Verdana, sans-serif'
                    }
                }
            }];
            config.legend = {
                enabled: legend
            };
            config.plotOptions = {
                scatter: {
                    marker: {
                        radius: 3,
                        fillColor: '#ff0000',
                        states: {
                            hover: {
                                enabled: true,
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    dataLabels: {
                        enabled: true,
                        allowOverlap: true,
                        formatter: function () {
                            return this.point.sname;
                        },
                        style: {
                            color: '#666666',
                            fontWeight: 'bold',
                            font: '11px "Trebuchet MS", Verdana, sans-serif'
                        }
                    },
                    states: {
                        hover: {
                            marker: {
                                enabled: false
                            }
                        }
                    }
                }
            };
            config.navigation = {
                buttonOptions: {
                    align: 'right'
                }
            };
            config.tooltip = {
                style: {
                    color: '#666666',
                    fontWeight: 'bold',
                    font: '11px "Trebuchet MS", Verdana, sans-serif'
                }
            };
            config.series = [{
                name: sname,
                labels: {
                    format: '{value}'
                },
                data: mydata
            }];
            return config;
        };
        var formatNumber = d3.format(",.2f"); // zero decimal places
        format = function (d) {
            return formatNumber(d);
        };
        $(document)
            .ready(function () {
                d3.tsv("../alpha_and_beta_diversity/benchmark.groups.summary",
                    function (error, data) {
                        if (error) {
                            console.log(error);
                        }
                        var cat = data.map(function (d) {
                            return d.group;
                        });
                        var sob_data = data.map(function (d) {
                            return +d.sobs
                        });
                        var chao_data = data.map(function (d) {
                            return +d.chao
                        });
                        var ace_data = data.map(function (d) {
                            return +d.ace
                        });
                        var jackknife_data = data.map(function (d) {
                            return +d.jackknife
                        });
                        var shannon_data = data.map(function (d) {
                            return +d.shannon
                        });
                        var npshannon_data = data.map(function (d) {
                            return +d.npshannon
                        });
                        var simpson_data = data.map(function (d) {
                            return +d.simpson
                        });
                        var dis = 10;
                        //now, creating a new chart is easy!
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "sob", "sob",
                            "sob distribution", sob_data,
                            dis, cat, "line", "Samples",
                            "number of observed OTUs",
                            false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "chao", "chao",
                            "chao distribution", chao_data,
                            dis, cat, "line", "Samples",
                            "Chao1 richness estimate",
                            false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "ace", "ace",
                            "ace distribution", ace_data,
                            dis, cat, "line", "Samples",
                            "ACE richness estimate", false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "jackknife", "jackknife",
                            "jackknife distribution",
                            jackknife_data, dis, cat,
                            "line", "Samples",
                            "Jackknife richness estimate",
                            false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "shannon", "shannon",
                            "shannon distribution",
                            shannon_data, dis, cat, "line",
                            "Samples",
                            "Shannon diversity index ",
                            false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "npshannon", "npshannon",
                            "npshannon distribution",
                            npshannon_data, dis, cat,
                            "line", "Samples",
                            "Non-parametric Shannon diversity index",
                            false)));
                        charts.push(new Highcharts.Chart(getChartConfig(
                            "simpson", "simpson",
                            "Simpson distribution",
                            simpson_data, dis, cat, "line",
                            "Samples",
                            "Simpson diversity index",
                            false)));
                    });
            });
    </script>
</head>

<body>
    <div id="outform"> <a href="/metaamp/index.html" id="logo">MetaAmp Logo</a>
        <h1>MetaAmp Version 2.0 </h1>
        <div id="sep"></div>
        <div id="space"></div>
        <h3>Alpha diversity indices visualization</h3>
        <div id="result">
            <div class="wrap">
                <div id="sob" class="left_col"></div>
                <div id="chao" class="right_col"></div>
            </div>
            <div class="wrap">
                <div id="ace" class="left_col"></div>
                <div id="jackknife" class="right_col"></div>
            </div>
            <div class="wrap">
                <div id="shannon" class="left_col"></div>
                <div id="npshannon" class="right_col"></div>
            </div>
            <div class="wrap">
                <div id="simpson" class="left_col"></div>
                <div id="empty" class="right_col"></div>
            </div>
        </div>
        <div id="space"></div>
        <div id="sep"></div>
        <div id="foot" align="center">Problems? Questions? Suggestions? Please contact <a href="mailto:xdong\@ucalgary.ca">Xiaoli Dong</a>            or <a HREF="mailto:mstrous\@ucalgary.ca">Marc Strous</a>
            <br><a href="http://www.ucalgary.ca/ebg/">Energy Bioengineering Group</a>            in <a href="http://geoscience.ucalgary.ca/">Department of Geoscience</a>            at <a href="http://www.ucalgary.ca">Univeristy of Calgary</a> </div>
    </div>
</body>

</html>
